import pandas as pd
import numpy as np
import sklearn
from sklearn.svm import SVC

data = pd.read_csv("iris.csv")
data = np.array(data)     # 变成array形式
np.random.shuffle(data)
percent = 0.8
'''
np.random.seed(7)
np.random.shuffle(data)          # 横向还是纵向
np.random.seed(7)
np.random.shuffle(y_train)
tf.random.set_seed(7)
'''

def train_test_splits(data, percent):
    train_size = int(data.shape[0]*percent)
    return data[:train_size], data[train_size:]


train_data, test_data = train_test_splits(data, percent)
# print(train_data.shape, test_data.shape)
# 分列
train_x_data = train_data[:, 0:train_data.shape[1] - 1]
train_y_data = train_data[:, train_data.shape[1]-1]
test_x_data = test_data[:, 0:test_data.shape[1] - 1]
test_y_data = test_data[:, test_data.shape[1]-1]
# print(train_x_data, train_y_data)
# 支持向量机模型
clf = SVC()
clf.fit(train_x_data, train_y_data)
score = clf.score(train_x_data, train_y_data)
ans = clf.predict(test_x_data)
ans = ans - test_y_data
print("模型准确率为：")
print(score)
print(ans)





